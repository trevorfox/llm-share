{"version":3,"file":"widget.umd.js","sources":["../src/icons/index.ts","../src/config/defaults.ts","../src/config/schema.ts","../src/utils/uuid.ts","../src/events/tracker.ts","../src/ui/styles.ts","../src/utils/browser.ts","../src/utils/clipboard.ts","../src/ui/Button.ts","../src/utils/share.ts","../src/utils/prompt.ts","../src/ui/Widget.ts","../src/widget.ts"],"sourcesContent":["/**\n * LLM icon SVGs (inline)\n */\n\nexport const CHATGPT_ICON = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>OpenAI icon</title>\n<path d=\"M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z\" fill=\"currentColor\"/>\n</svg>`;\n\nexport const CLAUDE_ICON = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Claude</title>\n<path d=\"M4.709 15.955l4.72-2.647.08-.23-.08-.128H9.2l-.79-.048-2.698-.073-2.339-.097-2.266-.122-.571-.121L0 11.784l.055-.352.48-.321.686.06 1.52.103 2.278.158 1.652.097 2.449.255h.389l.055-.157-.134-.098-.103-.097-2.358-1.596-2.552-1.688-1.336-.972-.724-.491-.364-.462-.158-1.008.656-.722.881.06.225.061.893.686 1.908 1.476 2.491 1.833.365.304.145-.103.019-.073-.164-.274-1.355-2.446-1.446-2.49-.644-1.032-.17-.619a2.97 2.97 0 01-.104-.729L6.283.134 6.696 0l.996.134.42.364.62 1.414 1.002 2.229 1.555 3.03.456.898.243.832.091.255h.158V9.01l.128-1.706.237-2.095.23-2.695.08-.76.376-.91.747-.492.584.28.48.685-.067.444-.286 1.851-.559 2.903-.364 1.942h.212l.243-.242.985-1.306 1.652-2.064.73-.82.85-.904.547-.431h1.033l.76 1.129-.34 1.166-1.064 1.347-.881 1.142-1.264 1.7-.79 1.36.073.11.188-.02 2.856-.606 1.543-.28 1.841-.315.833.388.091.395-.328.807-1.969.486-2.309.462-3.439.813-.042.03.049.061 1.549.146.662.036h1.622l3.02.225.79.522.474.638-.079.485-1.215.62-1.64-.389-3.829-.91-1.312-.329h-.182v.11l1.093 1.068 2.006 1.81 2.509 2.33.127.578-.322.455-.34-.049-2.205-1.657-.851-.747-1.926-1.62h-.128v.17l.444.649 2.345 3.521.122 1.08-.17.353-.608.213-.668-.122-1.374-1.925-1.415-2.167-1.143-1.943-.14.08-.674 7.254-.316.37-.729.28-.607-.461-.322-.747.322-1.476.389-1.924.315-1.53.286-1.9.17-.632-.012-.042-.14.018-1.434 1.967-2.18 2.945-1.726 1.845-.414.164-.717-.37.067-.662.401-.589 2.388-3.036 1.44-1.882.93-1.086-.006-.158h-.055L4.132 18.56l-1.13.146-.487-.456.061-.746.231-.243 1.908-1.312-.006.006z\" fill=\"currentColor\" fill-rule=\"evenodd\"/>\n</svg>`;\n\nexport const GEMINI_ICON = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Gemini</title>\n<path d=\"M20.616 10.835a14.147 14.147 0 01-4.45-3.001 14.111 14.111 0 01-3.678-6.452.503.503 0 00-.975 0 14.134 14.134 0 01-3.679 6.452 14.155 14.155 0 01-4.45 3.001c-.65.28-1.318.505-2.002.678a.502.502 0 000 .975c.684.172 1.35.397 2.002.677a14.147 14.147 0 014.45 3.001 14.112 14.112 0 013.679 6.453.502.502 0 00.975 0c.172-.685.397-1.351.677-2.003a14.145 14.145 0 013.001-4.45 14.113 14.113 0 016.453-3.678.503.503 0 000-.975 13.245 13.245 0 01-2.003-.678z\" fill=\"currentColor\" fill-rule=\"evenodd\"/>\n</svg>`;\n\nexport const PERPLEXITY_ICON = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Perplexity</title>\n<path d=\"M19.785 0v7.272H22.5V17.62h-2.935V24l-7.037-6.194v6.145h-1.091v-6.152L4.392 24v-6.465H1.5V7.188h2.884V0l7.053 6.494V.19h1.09v6.49L19.786 0zm-7.257 9.044v7.319l5.946 5.234V14.44l-5.946-5.397zm-1.099-.08l-5.946 5.398v7.235l5.946-5.234V8.965zm8.136 7.58h1.844V8.349H13.46l6.105 5.54v2.655zm-8.982-8.28H2.59v8.195h1.8v-2.576l6.192-5.62zM5.475 2.476v4.71h5.115l-5.115-4.71zm13.219 0l-5.115 4.71h5.115v-4.71z\" fill=\"currentColor\" fill-rule=\"evenodd\"/>\n</svg>`;\n\nexport const COPY_ICON = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Copy</title>\n<path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\" fill=\"currentColor\"/>\n</svg>`;\n\n/**\n * Get default icon for LLM ID\n */\nexport function getDefaultIcon(llmId: string): string | undefined {\n  const icons: Record<string, string> = {\n    chatgpt: CHATGPT_ICON,\n    claude: CLAUDE_ICON,\n    gemini: GEMINI_ICON,\n    perplexity: PERPLEXITY_ICON,\n    copy: COPY_ICON,\n  };\n  return icons[llmId.toLowerCase()];\n}\n\n","import type {\n  LLMShareConfig,\n  NormalizedLLMShareConfig,\n  WidgetMode,\n  LLMConfig,\n  LLMAction,\n} from './types';\nimport {\n  CHATGPT_ICON,\n  CLAUDE_ICON,\n  GEMINI_ICON,\n  PERPLEXITY_ICON,\n  COPY_ICON,\n} from '../icons';\n\n/**\n * LLM metadata mapping\n */\nconst LLM_METADATA: Record<string, { label: string; iconSvg: string; urlTemplate?: string }> = {\n  chatgpt: { \n    label: 'ChatGPT', \n    iconSvg: CHATGPT_ICON,\n    urlTemplate: 'https://chat.openai.com/?q={prompt}'\n  },\n  claude: { \n    label: 'Claude', \n    iconSvg: CLAUDE_ICON,\n    urlTemplate: 'https://claude.ai/new?q={prompt}'\n  },\n  gemini: { \n    label: 'Gemini', \n    iconSvg: GEMINI_ICON,\n    urlTemplate: 'https://aistudio.google.com/prompts/new_chat?prompt={prompt}'\n  },\n  perplexity: { \n    label: 'Perplexity', \n    iconSvg: PERPLEXITY_ICON,\n    urlTemplate: 'https://www.perplexity.ai/search?q={prompt}'\n  },\n  copy: {\n    label: 'Copy',\n    iconSvg: COPY_ICON,\n  },\n};\n\n/**\n * Default LLM names\n */\nconst DEFAULT_LLM_NAMES = ['chatgpt', 'claude', 'perplexity', 'copy'];\n\n/**\n * Expand LLM names array into LLMConfig objects\n */\nfunction expandLLMs(llmNames: string[], action: LLMAction): LLMConfig[] {\n  return llmNames.map((name) => {\n    const normalizedName = name.toLowerCase();\n    const metadata = LLM_METADATA[normalizedName];\n    \n    // Special handling for 'copy' LLM - always use 'copy' action\n    const llmAction = normalizedName === 'copy' ? 'copy' : action;\n    \n    if (!metadata) {\n      // Fallback for unknown LLM names\n      return {\n        id: normalizedName,\n        label: name.charAt(0).toUpperCase() + name.slice(1),\n        action: llmAction,\n      };\n    }\n    return {\n      id: normalizedName,\n      label: metadata.label,\n      action: llmAction,\n      iconSvg: metadata.iconSvg,\n      // Include URL template when action is 'link'\n      urlTemplate: llmAction === 'link' ? metadata.urlTemplate : undefined,\n    };\n  });\n}\n\n/**\n * Detect mode based on config\n */\nfunction detectMode(config: LLMShareConfig): WidgetMode {\n  if (config.mode) {\n    return config.mode;\n  }\n  // If siteId/publicKey present, default to hosted\n  if (config.siteId || config.publicKey) {\n    return 'hosted';\n  }\n  // Otherwise standalone\n  return 'standalone';\n}\n\n/**\n * Get default endpoints for hosted mode\n */\nfunction getDefaultEndpoints(mode: WidgetMode): {\n  collector: string | null;\n  share: string | null;\n  redirectBase: string | null;\n} {\n  if (mode === 'hosted') {\n    // Default to your SaaS endpoints (can be overridden)\n    return {\n      collector: 'https://c.getsourced.ai/v1/events',\n      share: 'https://c.getsourced.ai/v1/share',\n      redirectBase: 'https://t.getsourced.ai/s/',\n    };\n  }\n  return {\n    collector: null,\n    share: null,\n    redirectBase: null,\n  };\n}\n\n/**\n * Apply smart defaults to config\n */\nexport function applyDefaults(\n  config: LLMShareConfig\n): NormalizedLLMShareConfig {\n  const mode = detectMode(config);\n  const defaultEndpoints = getDefaultEndpoints(mode);\n  \n  // Get action (default to 'link')\n  const action: LLMAction = config.action ?? 'link';\n  \n  // Expand LLM names to full configs\n  const llmNames = config.llms && config.llms.length > 0 \n    ? config.llms \n    : DEFAULT_LLM_NAMES;\n  const llms = expandLLMs(llmNames, action);\n\n  return {\n    version: config.version || '1',\n    siteId: config.siteId ?? null,\n    publicKey: config.publicKey ?? null,\n    mode,\n    endpoints: {\n      collector:\n        config.endpoints?.collector ?? defaultEndpoints.collector ?? null,\n      share: config.endpoints?.share ?? defaultEndpoints.share ?? null,\n      redirectBase:\n        config.endpoints?.redirectBase ??\n        defaultEndpoints.redirectBase ??\n        null,\n    },\n    widget: {\n      placement: config.widget?.placement ?? 'bottom-left',\n      style: config.widget?.style ?? 'minimal',\n      theme: config.widget?.theme ?? 'auto',\n      zIndex: config.widget?.zIndex ?? 9999,\n      offsetPx: config.widget?.offsetPx ?? 16,\n      backgroundOpacity: config.widget?.backgroundOpacity ?? 0.5,\n      inlineSelector: config.widget?.inlineSelector ?? null,\n      inlineAlignment: config.widget?.inlineAlignment ?? 'left',\n      showOnMobile: config.widget?.showOnMobile ?? true,\n      showOn: {\n        pathPrefix: config.widget?.showOn?.pathPrefix ?? '/',\n        scrollDistance: config.widget?.showOn?.scrollDistance ?? 200,\n        showOnScroll: config.widget?.showOn?.showOnScroll ?? false,\n      },\n      textLabel: {\n        enabled: config.widget?.textLabel?.enabled ?? false,\n        text: config.widget?.textLabel?.text ?? 'Explore with AI',\n        position: config.widget?.textLabel?.position ?? 'top',\n        hideDelay: config.widget?.textLabel?.hideDelay ?? 3000,\n      },\n    },\n    content: {\n      prompt:\n        config.content?.prompt ??\n        'Summarize this page and answer my question:',\n      includePageTitle: config.content?.includePageTitle ?? true,\n      includeSelectedText: config.content?.includeSelectedText ?? true,\n    },\n    llms,\n    tracking: {\n      enabled: config.tracking?.enabled ?? mode !== 'standalone',\n      batch: config.tracking?.batch ?? true,\n      flushIntervalMs: config.tracking?.flushIntervalMs ?? 8000,\n      respectDNT: config.tracking?.respectDNT ?? true,\n      pushToDataLayer: config.tracking?.pushToDataLayer ?? false,\n      dataLayerName: config.tracking?.dataLayerName ?? 'dataLayer',\n    },\n    callbacks: {\n      onEvent: config.callbacks?.onEvent ?? null,\n      onReady: config.callbacks?.onReady ?? null,\n    },\n    debug: {\n      logToConsole: config.debug?.logToConsole ?? false,\n    },\n  };\n}\n\n","import type { LLMShareConfig, NormalizedLLMShareConfig } from './types';\nimport { applyDefaults } from './defaults';\n\n/**\n * Validate and normalize config\n */\nexport function validateConfig(\n  config: unknown\n): NormalizedLLMShareConfig {\n  // Basic type check\n  if (!config || typeof config !== 'object') {\n    throw new Error('LLMShare config must be an object');\n  }\n\n  const configObj = config as LLMShareConfig;\n\n  // Validate mode if provided\n  if (configObj.mode) {\n    const validModes = ['hosted', 'self_hosted', 'standalone'];\n    if (!validModes.includes(configObj.mode)) {\n      throw new Error(\n        `Invalid mode: ${configObj.mode}. Must be one of: ${validModes.join(', ')}`\n      );\n    }\n  }\n\n  // Validate widget placement if provided\n  if (configObj.widget?.placement) {\n    const validPlacements = [\n      'center-right',\n      'center-left',\n      'bottom-right',\n      'bottom-left',\n      'inline',\n    ];\n    if (!validPlacements.includes(configObj.widget.placement)) {\n      throw new Error(\n        `Invalid placement: ${configObj.widget.placement}. Must be one of: ${validPlacements.join(', ')}`\n      );\n    }\n  }\n  \n  // Validate textLabel position if provided\n  if (configObj.widget?.textLabel?.position) {\n    const validPositions = ['left', 'right', 'top'];\n    if (!validPositions.includes(configObj.widget.textLabel.position)) {\n      throw new Error(\n        `Invalid textLabel position: ${configObj.widget.textLabel.position}. Must be one of: ${validPositions.join(', ')}`\n      );\n    }\n  }\n\n  // Validate widget style if provided\n  if (configObj.widget?.style) {\n    const validStyles = ['pill', 'square', 'minimal', 'custom'];\n    if (!validStyles.includes(configObj.widget.style)) {\n      throw new Error(\n        `Invalid style: ${configObj.widget.style}. Must be one of: ${validStyles.join(', ')}`\n      );\n    }\n  }\n\n  // Validate widget theme if provided\n  if (configObj.widget?.theme) {\n    const validThemes = ['auto', 'light', 'dark'];\n    if (!validThemes.includes(configObj.widget.theme)) {\n      throw new Error(\n        `Invalid theme: ${configObj.widget.theme}. Must be one of: ${validThemes.join(', ')}`\n      );\n    }\n  }\n\n  // Validate action if provided\n  if (configObj.action) {\n    if (!['copy', 'link'].includes(configObj.action)) {\n      throw new Error(`Invalid action: ${configObj.action}. Must be 'copy' or 'link'`);\n    }\n  }\n\n  // Validate LLMs if provided\n  if (configObj.llms) {\n    if (!Array.isArray(configObj.llms)) {\n      throw new Error('llms must be an array');\n    }\n    for (const llm of configObj.llms) {\n      if (typeof llm !== 'string') {\n        throw new Error('Each LLM must be a string (LLM name)');\n      }\n    }\n  }\n\n  // Apply defaults and return normalized config\n  return applyDefaults(configObj);\n}\n\n/**\n * Get config from window.LLMShare\n */\nexport function getConfig(): NormalizedLLMShareConfig | null {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n\n  const windowWithConfig = window as typeof window & {\n    LLMShare?: LLMShareConfig;\n  };\n\n  if (!windowWithConfig.LLMShare) {\n    return null;\n  }\n\n  try {\n    return validateConfig(windowWithConfig.LLMShare);\n  } catch (error) {\n    console.error('[LLMShare] Config validation error:', error);\n    return null;\n  }\n}\n\n","/**\n * Generate UUID v4\n */\nexport function generateUUID(): string {\n  // Simple UUID v4 implementation\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n","import type {\n  LLMShareEvent,\n  EventType,\n  ImpressionEvent,\n  ClickEvent,\n  ShareCreatedEvent,\n  FallbackRawUrlEvent,\n  ErrorEvent,\n} from './types';\nimport type { NormalizedLLMShareConfig } from '../config/types';\nimport { generateUUID } from '../utils/uuid';\n\n/**\n * Event tracker - handles event creation, batching, and sending\n */\nexport class EventTracker {\n  private config: NormalizedLLMShareConfig;\n  private viewId: string;\n  private eventQueue: LLMShareEvent[] = [];\n  private flushTimer: number | null = null;\n  private unloadHandler: (() => void) | null = null;\n\n  constructor(config: NormalizedLLMShareConfig) {\n    this.config = config;\n    this.viewId = generateUUID();\n    this.setupUnloadHandler();\n  }\n\n  /**\n   * Collect browser attribution data\n   */\n  private getAttributionData(): {\n    referrer?: string;\n    language?: string;\n    timezone?: string;\n    screen_width?: number;\n    screen_height?: number;\n    viewport_width?: number;\n    viewport_height?: number;\n  } {\n    if (typeof window === 'undefined' || typeof navigator === 'undefined') {\n      return {};\n    }\n\n    try {\n      const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n      return {\n        referrer: document.referrer || undefined,\n        language: navigator.language || undefined,\n        timezone: timezone || undefined,\n        screen_width: window.screen?.width || undefined,\n        screen_height: window.screen?.height || undefined,\n        viewport_width: window.innerWidth || undefined,\n        viewport_height: window.innerHeight || undefined,\n      };\n    } catch (error) {\n      // Silently fail if attribution data can't be collected\n      return {};\n    }\n  }\n\n  /**\n   * Get current view ID\n   */\n  getViewId(): string {\n    return this.viewId;\n  }\n\n  /**\n   * Create base event object\n   */\n  private createBaseEvent(eventType: EventType): Partial<LLMShareEvent> {\n    return {\n      event_id: generateUUID(),\n      ts: new Date().toISOString(),\n      event_type: eventType,\n      site_id: this.config.siteId || null,\n      page_url: typeof window !== 'undefined' ? window.location.href : '',\n      view_id: this.viewId,\n      mode: this.config.mode,\n      ...this.getAttributionData(),\n    };\n  }\n\n  /**\n   * Push event to dataLayer if enabled\n   */\n  private pushToDataLayer(event: LLMShareEvent): void {\n    if (!this.config.tracking.pushToDataLayer || typeof window === 'undefined') {\n      return;\n    }\n\n    try {\n      const dataLayerName = this.config.tracking.dataLayerName;\n      const windowWithDataLayer = window as typeof window & {\n        [key: string]: unknown[];\n      };\n\n      // Initialize dataLayer if it doesn't exist\n      if (!windowWithDataLayer[dataLayerName]) {\n        windowWithDataLayer[dataLayerName] = [];\n      }\n\n      // Push event to dataLayer\n      windowWithDataLayer[dataLayerName].push(event);\n    } catch (error) {\n      if (this.config.debug.logToConsole) {\n        console.error('[LLMShare] Error pushing to dataLayer:', error);\n      }\n    }\n  }\n\n  /**\n   * Emit an event\n   */\n  emit(event: LLMShareEvent): void {\n    // Send to callback if provided\n    if (this.config.callbacks.onEvent) {\n      try {\n        this.config.callbacks.onEvent(event);\n      } catch (error) {\n        if (this.config.debug.logToConsole) {\n          console.error('[LLMShare] Error in onEvent callback:', error);\n        }\n      }\n    }\n\n    // Push to dataLayer if enabled\n    this.pushToDataLayer(event);\n\n    // Log to console if debug mode enabled\n    if (this.config.debug.logToConsole) {\n      console.log('[LLMShare] Event:', event);\n    }\n\n    // Queue for batch send if tracking enabled\n    if (this.config.tracking.enabled && this.config.endpoints.collector) {\n      this.eventQueue.push(event);\n      this.scheduleFlush();\n    }\n  }\n\n  /**\n   * Track impression (widget rendered)\n   */\n  trackImpression(): void {\n    const event: ImpressionEvent = {\n      ...this.createBaseEvent('impression'),\n    } as ImpressionEvent;\n    this.emit(event);\n  }\n\n  /**\n   * Track click (LLM button clicked)\n   */\n  trackClick(llmId: string): void {\n    const event: ClickEvent = {\n      ...this.createBaseEvent('click'),\n      llm_id: llmId,\n    } as ClickEvent;\n    this.emit(event);\n  }\n\n  /**\n   * Track share created (share endpoint returned token/url)\n   */\n  trackShareCreated(\n    llmId: string,\n    shareUrl?: string,\n    shareToken?: string\n  ): void {\n    const event: ShareCreatedEvent = {\n      ...this.createBaseEvent('share_created'),\n      llm_id: llmId,\n      share_url: shareUrl,\n      share_token: shareToken,\n    } as ShareCreatedEvent;\n    this.emit(event);\n  }\n\n  /**\n   * Track fallback to raw URL (share failed)\n   */\n  trackFallbackRawUrl(llmId: string, rawUrl: string): void {\n    const event: FallbackRawUrlEvent = {\n      ...this.createBaseEvent('fallback_raw_url'),\n      llm_id: llmId,\n      raw_url: rawUrl,\n    } as FallbackRawUrlEvent;\n    this.emit(event);\n  }\n\n  /**\n   * Track error (non-fatal issues)\n   */\n  trackError(errorMessage: string, errorType?: string): void {\n    const event: ErrorEvent = {\n      ...this.createBaseEvent('error'),\n      error_message: errorMessage,\n      error_type: errorType,\n    } as ErrorEvent;\n    this.emit(event);\n  }\n\n  /**\n   * Schedule flush of event queue\n   */\n  private scheduleFlush(): void {\n    if (this.flushTimer !== null) {\n      return; // Already scheduled\n    }\n\n    if (this.config.tracking.batch) {\n      // Use requestIdleCallback if available, otherwise setTimeout\n      if (typeof requestIdleCallback !== 'undefined') {\n        requestIdleCallback(() => {\n          this.flushTimer = null;\n          this.flush();\n        });\n      } else {\n        this.flushTimer = window.setTimeout(() => {\n          this.flushTimer = null;\n          this.flush();\n        }, this.config.tracking.flushIntervalMs);\n      }\n    } else {\n      // Flush immediately if batching disabled\n      this.flush();\n    }\n  }\n\n  /**\n   * Flush event queue to collector endpoint\n   */\n  private async flush(): Promise<void> {\n    if (this.eventQueue.length === 0) {\n      return;\n    }\n\n    // Check DNT if enabled\n    if (\n      this.config.tracking.respectDNT &&\n      typeof navigator !== 'undefined' &&\n      navigator.doNotTrack === '1'\n    ) {\n      this.eventQueue = [];\n      return;\n    }\n\n    const events = [...this.eventQueue];\n    this.eventQueue = [];\n\n    if (!this.config.endpoints.collector) {\n      return;\n    }\n\n    try {\n      const response = await fetch(this.config.endpoints.collector, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          events,\n          site_id: this.config.siteId,\n          public_key: this.config.publicKey,\n        }),\n        keepalive: true, // Ensure request completes even if page unloads\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n    } catch (error) {\n      // Silently fail - don't spam console unless debug mode\n      if (this.config.debug.logToConsole) {\n        console.error('[LLMShare] Failed to send events:', error);\n      }\n      // Re-queue events for retry (limit to prevent memory issues)\n      if (this.eventQueue.length < 100) {\n        this.eventQueue.unshift(...events);\n      }\n    }\n  }\n\n  /**\n   * Setup unload handler to flush events on page unload\n   */\n  private setupUnloadHandler(): void {\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    this.unloadHandler = () => {\n      // Flush immediately on unload\n      if (this.eventQueue.length > 0) {\n        // Use sendBeacon if available for reliable delivery\n        if (\n          typeof navigator !== 'undefined' &&\n          navigator.sendBeacon &&\n          this.config.endpoints.collector\n        ) {\n          const payload = JSON.stringify({\n            events: this.eventQueue,\n            site_id: this.config.siteId,\n            public_key: this.config.publicKey,\n          });\n          navigator.sendBeacon(\n            this.config.endpoints.collector,\n            new Blob([payload], { type: 'application/json' })\n          );\n        } else {\n          // Fallback to sync fetch (blocks unload but ensures delivery)\n          const xhr = new XMLHttpRequest();\n          xhr.open(\n            'POST',\n            this.config.endpoints.collector || '',\n            false\n          );\n          xhr.setRequestHeader('Content-Type', 'application/json');\n          xhr.send(\n            JSON.stringify({\n              events: this.eventQueue,\n              site_id: this.config.siteId,\n              public_key: this.config.publicKey,\n            })\n          );\n        }\n      }\n    };\n\n    window.addEventListener('beforeunload', this.unloadHandler);\n    window.addEventListener('pagehide', this.unloadHandler);\n  }\n\n  /**\n   * Cleanup\n   */\n  destroy(): void {\n    // Flush remaining events\n    this.flush();\n\n    // Remove unload handler\n    if (this.unloadHandler && typeof window !== 'undefined') {\n      window.removeEventListener('beforeunload', this.unloadHandler);\n      window.removeEventListener('pagehide', this.unloadHandler);\n    }\n\n    // Clear flush timer\n    if (this.flushTimer !== null) {\n      clearTimeout(this.flushTimer);\n      this.flushTimer = null;\n    }\n  }\n}\n\n","import type { NormalizedLLMShareConfig } from '../config/types';\nimport { getPreferredColorScheme } from '../utils/browser';\n\n/**\n * Get effective theme (resolve 'auto' to light/dark)\n */\nexport function getEffectiveTheme(config: NormalizedLLMShareConfig): 'light' | 'dark' {\n  if (config.widget.theme === 'auto') {\n    return getPreferredColorScheme();\n  }\n  return config.widget.theme;\n}\n\n/**\n * Generate CSS styles for widget\n */\nexport function generateStyles(config: NormalizedLLMShareConfig): string {\n  const theme = getEffectiveTheme(config);\n  const isDark = theme === 'dark';\n  const opacity = config.widget.backgroundOpacity ?? 1.0;\n\n  // Style-specific adjustments\n  let borderRadius = '8px';\n  const padding = '8px 16px'; // Reduced vertical padding from 12px to 8px\n  \n  if (config.widget.style === 'pill') {\n    borderRadius = '24px';\n  } else if (config.widget.style === 'square') {\n    borderRadius = '0px'; // Truly square corners\n  } else if (config.widget.style === 'minimal') {\n    borderRadius = '4px';\n  }\n\n  // Convert opacity to rgba alpha value\n  // Dark mode always uses solid black for better visibility\n  const backgroundDark = isDark ? '#000000' : `rgba(0, 0, 0, ${opacity})`;\n  const backgroundLight = `rgba(255, 255, 255, ${opacity})`;\n  // Text-right background respects theme\n  const backgroundRight = isDark ? '#000000' : `rgba(255, 255, 255, ${opacity})`;\n\n  return `\n    .llm-share-widget {\n      position: fixed;\n      z-index: ${config.widget.zIndex};\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n      font-size: 14px;\n      line-height: 1.5;\n      box-sizing: border-box;\n      transition: transform 0.3s ease-out;\n    }\n    \n    .llm-share-widget.scroll-hidden {\n      transform: translateY(100%);\n    }\n    \n    .llm-share-widget-container {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      background: ${isDark ? backgroundDark : backgroundLight};\n      border: 1px solid ${isDark ? '#999' : '#e5e5e5'};\n      border-radius: ${borderRadius};\n      padding: ${padding};\n      box-shadow: 0 4px 12px rgba(0, 0, 0, ${isDark ? '0.5' : '0.15'});\n      transition: all 0.3s ease-out;\n      width: fit-content;\n      min-height: 40px;\n    }\n    \n    /* Square style: more prominent with stronger border and shadow */\n    .llm-share-widget-container.style-square {\n      border: 2px solid ${isDark ? '#666' : '#ccc'} !important;\n      border-radius: 0px !important;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, ${isDark ? '0.6' : '0.2'}) !important;\n    }\n    \n    /* Minimal style: more subtle with lighter border and less shadow */\n    .llm-share-widget-container.style-minimal {\n      border: 1px solid ${isDark ? '#333' : '#e0e0e0'} !important;\n      box-shadow: 0 2px 6px rgba(0, 0, 0, ${isDark ? '0.3' : '0.1'}) !important;\n    }\n    \n    /* When text label is on the right, respect theme */\n    .llm-share-widget-container.text-right {\n      background: ${backgroundRight};\n      border: 1px solid ${isDark ? '#333' : '#e5e5e5'};\n    }\n    \n    /* Ensure style classes override text-right border */\n    .llm-share-widget-container.text-right.style-square {\n      border: 2px solid ${isDark ? '#666' : '#ccc'} !important;\n    }\n    \n    .llm-share-widget-container.text-right.style-minimal {\n      border: 1px solid ${isDark ? '#333' : '#e0e0e0'} !important;\n    }\n    \n    .llm-share-widget-container.layout-horizontal {\n      flex-direction: row;\n    }\n    \n    .llm-share-widget-container.layout-vertical {\n      flex-direction: column;\n      align-items: flex-start;\n    }\n    \n    .llm-share-text-label {\n      overflow: hidden;\n      transition: width 0.3s ease-out, opacity 0.3s ease-out;\n      width: 0;\n      opacity: 0;\n      display: flex;\n      align-items: center;\n      justify-content: flex-start;\n      height: 24px;\n      margin: 0;\n      padding: 0;\n      white-space: nowrap;\n    }\n    \n    .llm-share-text-label.text-visible {\n      width: var(--text-label-width, 150px);\n      opacity: 1;\n    }\n    \n    .llm-share-widget-container.layout-vertical .llm-share-text-label {\n      width: auto;\n      opacity: 1;\n      transition: opacity 0.3s ease-out;\n      height: auto;\n    }\n    \n    .llm-share-widget-container.layout-vertical .llm-share-text-label.text-visible {\n      width: auto;\n    }\n    \n    .llm-share-text-label span {\n      font-weight: 500;\n      font-size: 14px;\n      color: ${isDark ? '#999' : '#1a1a1a'};\n      white-space: nowrap;\n      display: block;\n      line-height: 1;\n      margin: 0;\n      padding: 0;\n      text-indent: 0;\n    }\n    \n    /* Text color when text label is on the right - respects theme */\n    .llm-share-widget-container.text-right.theme-light .llm-share-text-label span {\n      color: #1a1a1a;\n    }\n    .llm-share-widget-container.text-right.theme-dark .llm-share-text-label span {\n      color: #999;\n    }\n    \n    /* Light theme: black icons and text */\n    .llm-share-widget-container.theme-light .llm-share-icon {\n      color: #1a1a1a !important;\n    }\n    \n    .llm-share-widget-container.theme-light .llm-share-text-label span {\n      color: #1a1a1a !important;\n    }\n    \n    /* Dark theme: white icons and gray text */\n    .llm-share-widget-container.theme-dark .llm-share-icon {\n      color: #ffffff !important;\n    }\n    \n    .llm-share-widget-container.theme-dark .llm-share-text-label span {\n      color: #999 !important;\n    }\n    \n    .llm-share-buttons-wrapper {\n      display: flex;\n      align-items: center;\n      gap: 16px;\n      flex-shrink: 0;\n      height: 24px;\n      margin: 0;\n      padding: 0;\n    }\n    \n    .llm-share-widget.inline {\n      position: static;\n      display: inline-block;\n      width: fit-content;\n      vertical-align: top;\n      margin: 0;\n      padding: 0;\n      line-height: 0;\n    }\n    \n    .llm-share-widget.inline.align-left {\n      margin-right: auto;\n    }\n    \n    .llm-share-widget.inline.align-center {\n      margin-left: auto;\n      margin-right: auto;\n      display: block;\n    }\n    \n    .llm-share-widget.inline.align-right {\n      margin-left: auto;\n      display: block;\n    }\n    \n    /* Ensure inline widget containers have symmetric vertical spacing */\n    .llm-share-widget.inline .llm-share-widget-container {\n      width: fit-content;\n      margin: 0;\n      vertical-align: top;\n      min-height: auto;\n      display: inline-flex;\n    }\n    \n    .llm-share-widget-container {\n      width: fit-content;\n    }\n    \n    .llm-share-button {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 0;\n      margin: 0;\n      background: transparent;\n      border: none;\n      cursor: pointer;\n      transition: opacity 0.3s ease;\n      text-decoration: none;\n      line-height: 0;\n      width: 24px;\n      height: 24px;\n      box-sizing: border-box;\n    }\n    \n    .llm-share-button:hover {\n      opacity: 0.8;\n    }\n    \n    .llm-share-button:active {\n      transform: scale(0.95);\n    }\n    \n    /* Only show focus outline for keyboard navigation (not mouse clicks) */\n    .llm-share-button:focus {\n      outline: none;\n    }\n    \n    /* Enhanced focus styles for keyboard navigation (WCAG AA compliant) */\n    .llm-share-button:focus-visible {\n      outline: 3px solid ${isDark ? '#60a5fa' : '#0052cc'};\n      outline-offset: 3px;\n      border-radius: 4px;\n      box-shadow: 0 0 0 1px ${isDark ? 'rgba(96, 165, 250, 0.3)' : 'rgba(0, 82, 204, 0.3)'};\n    }\n    \n    .llm-share-icon {\n      width: 24px;\n      height: 24px;\n      flex-shrink: 0;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: ${isDark ? '#ffffff' : '#1a1a1a'};\n      line-height: 0;\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n    \n    /* Black icons when text label is on the right */\n    .llm-share-widget-container.text-right .llm-share-icon {\n      color: #1a1a1a;\n    }\n    \n    .llm-share-icon svg {\n      width: 100%;\n      height: 100%;\n      display: block;\n      margin: 0;\n      padding: 0;\n      flex-shrink: 0;\n    }\n    \n    .llm-share-icon img {\n      width: 100%;\n      height: 100%;\n      display: block;\n      object-fit: contain;\n      margin: 0;\n      padding: 0;\n      flex-shrink: 0;\n    }\n    \n    .llm-share-label {\n      flex: 1;\n    }\n    \n    @media (max-width: 768px) {\n      .llm-share-icon {\n        width: 20px;\n        height: 20px;\n      }\n      \n      .llm-share-button {\n        width: 20px;\n        height: 20px;\n        min-width: 44px;\n        min-height: 44px;\n        padding: 12px;\n      }\n      \n      .llm-share-buttons-wrapper {\n        gap: 12px;\n      }\n      \n      .llm-share-widget-container {\n        padding: 10px 12px;\n        min-height: 44px;\n      }\n      \n      /* Adjust offset for mobile bottom placements to prevent overlap with browser UI */\n      .llm-share-widget.placement-bottom-left:not(.inline),\n      .llm-share-widget.placement-bottom-right:not(.inline) {\n        bottom: max(env(safe-area-inset-bottom, 0px), 16px) !important;\n      }\n      \n      /* Adjust horizontal positioning for mobile */\n      .llm-share-widget.placement-bottom-left:not(.inline),\n      .llm-share-widget.placement-center-left:not(.inline) {\n        left: max(env(safe-area-inset-left, 0px), 12px) !important;\n      }\n      \n      .llm-share-widget.placement-bottom-right:not(.inline),\n      .llm-share-widget.placement-center-right:not(.inline) {\n        right: max(env(safe-area-inset-right, 0px), 12px) !important;\n      }\n      \n      /* Ensure text label is readable on mobile */\n      .llm-share-text-label span {\n        font-size: 13px;\n      }\n      \n      /* Stack vertically on very small screens if horizontal layout */\n      @media (max-width: 480px) {\n        .llm-share-widget-container.layout-horizontal {\n          flex-wrap: wrap;\n        }\n        \n        .llm-share-widget-container {\n          padding: 8px 10px;\n        }\n        \n        .llm-share-buttons-wrapper {\n          gap: 10px;\n        }\n      }\n    }\n  `;\n}\n\n/**\n * Inject styles into document\n */\nexport function injectStyles(config: NormalizedLLMShareConfig): void {\n  if (typeof document === 'undefined') {\n    return;\n  }\n\n  const styleId = 'llm-share-widget-styles';\n  \n  // Remove existing styles if present\n  const existing = document.getElementById(styleId);\n  if (existing) {\n    existing.remove();\n  }\n\n  // Create and inject style element\n  const style = document.createElement('style');\n  style.id = styleId;\n  style.textContent = generateStyles(config);\n  document.head.appendChild(style);\n}\n\n","/**\n * Browser feature detection utilities\n */\n\n/**\n * Check if browser supports required features\n */\nexport function isBrowserSupported(): boolean {\n  if (typeof window === 'undefined') {\n    return false;\n  }\n\n  // Check for required APIs\n  if (\n    typeof fetch === 'undefined' ||\n    typeof Promise === 'undefined' ||\n    typeof document === 'undefined'\n  ) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Get prefers-color-scheme value\n */\nexport function getPreferredColorScheme(): 'light' | 'dark' {\n  if (typeof window === 'undefined' || !window.matchMedia) {\n    return 'light';\n  }\n\n  if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n    return 'dark';\n  }\n\n  return 'light';\n}\n\n/**\n * Check if clipboard API is available\n */\nexport function isClipboardAPIAvailable(): boolean {\n  return (\n    typeof navigator !== 'undefined' &&\n    typeof navigator.clipboard !== 'undefined' &&\n    typeof navigator.clipboard.writeText === 'function'\n  );\n}\n\n/**\n * Check if device is mobile based on screen width and user agent\n */\nexport function isMobileDevice(): boolean {\n  if (typeof window === 'undefined') {\n    return false;\n  }\n\n  // Check screen width (most reliable)\n  const isSmallScreen = window.innerWidth <= 768;\n  \n  // Check user agent as secondary indicator\n  // Note: window.opera is a legacy property for very old Opera browsers\n  const userAgent = navigator.userAgent || navigator.vendor || (typeof window !== 'undefined' && 'opera' in window ? String((window as Record<string, unknown>).opera) : '');\n  const isMobileUA = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent.toLowerCase());\n  \n  // Consider it mobile if either condition is true\n  return isSmallScreen || isMobileUA;\n}\n\n","import { isClipboardAPIAvailable } from './browser';\n\n/**\n * Copy text to clipboard with fallback\n */\nexport async function copyToClipboard(text: string): Promise<boolean> {\n  if (typeof navigator === 'undefined') {\n    return false;\n  }\n\n  // Try modern Clipboard API first\n  if (isClipboardAPIAvailable()) {\n    try {\n      await navigator.clipboard.writeText(text);\n      return true;\n    } catch (error) {\n      // Fall through to fallback\n    }\n  }\n\n  // Fallback to execCommand for older browsers\n  if (typeof document !== 'undefined') {\n    try {\n      const textArea = document.createElement('textarea');\n      textArea.value = text;\n      textArea.style.position = 'fixed';\n      textArea.style.left = '-999999px';\n      textArea.style.top = '-999999px';\n      document.body.appendChild(textArea);\n      textArea.focus();\n      textArea.select();\n\n      const success = document.execCommand('copy');\n      document.body.removeChild(textArea);\n\n      return success;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  return false;\n}\n\n","import type { LLMConfig, NormalizedLLMShareConfig } from '../config/types';\nimport { copyToClipboard } from '../utils/clipboard';\nimport { composePrompt } from '../utils/prompt';\nimport type { EventTracker } from '../events/tracker';\nimport { createShareUrl } from '../utils/share';\n\n/**\n * Create LLM button element\n */\nexport function createLLMButton(\n  llm: LLMConfig,\n  config: NormalizedLLMShareConfig,\n  tracker: EventTracker,\n  _container: HTMLElement\n): HTMLElement {\n  // Use anchor tag for link actions, button for copy actions\n  const element = llm.action === 'link' && llm.urlTemplate\n    ? document.createElement('a')\n    : document.createElement('button');\n  \n  element.className = 'llm-share-button';\n  \n  // Set aria-label based on action type\n  const ariaLabel = llm.action === 'copy'\n    ? `Copy page content to ${llm.label}`\n    : `Open current page in ${llm.label} to ask questions`;\n  element.setAttribute('aria-label', ariaLabel);\n  \n  if (element instanceof HTMLButtonElement) {\n    element.setAttribute('type', 'button');\n  } else if (element instanceof HTMLAnchorElement) {\n    element.setAttribute('rel', 'noopener noreferrer');\n    element.setAttribute('target', '_blank');\n    element.setAttribute('title', llm.label);\n  }\n\n  // Add icon if available\n  if (llm.iconSvg) {\n    const iconContainer = document.createElement('span');\n    iconContainer.className = 'llm-share-icon';\n    iconContainer.setAttribute('aria-hidden', 'true'); // Decorative icon, hidden from screen readers\n    iconContainer.innerHTML = llm.iconSvg;\n    element.appendChild(iconContainer);\n  } else if (llm.iconUrl) {\n    const icon = document.createElement('img');\n    icon.className = 'llm-share-icon';\n    icon.src = llm.iconUrl;\n    icon.alt = `${llm.label} icon`;\n    element.appendChild(icon);\n  }\n\n  // Don't show labels by default - icon-only mode for ExploreWithAI style\n  // Labels can be shown by setting widget.style to something other than 'minimal'\n  // or by explicitly configuring showLabels in the future\n\n  // Handle click or set href\n  if (llm.action === 'link' && llm.urlTemplate && element instanceof HTMLAnchorElement) {\n    // Generate URL immediately for link actions\n    const url = generateLLMUrl(llm, config);\n    if (config.debug.logToConsole) {\n      console.log(`[LLMShare] Generated URL for ${llm.id}:`, url);\n    }\n    if (url) {\n      element.href = url;\n      // Add click handler to track and ensure link opens\n      element.addEventListener('click', (e) => {\n        // Track click\n        tracker.trackClick(llm.id);\n        // Use window.open to ensure it opens in new tab\n        e.preventDefault();\n        const opened = window.open(url, '_blank', 'noopener,noreferrer');\n        if (!opened && config.debug.logToConsole) {\n          console.warn(`[LLMShare] Failed to open ${llm.id} link - popup may be blocked`);\n        }\n      });\n    } else {\n      // If URL generation fails, fall back to button behavior\n      const button = document.createElement('button');\n      button.className = element.className;\n      button.setAttribute('type', 'button');\n      // Preserve the aria-label from the element (which is already set for link action)\n      button.setAttribute('aria-label', element.getAttribute('aria-label') || `Open current page in ${llm.label} to ask questions`);\n      // Copy children\n      while (element.firstChild) {\n        button.appendChild(element.firstChild);\n      }\n      if (element.parentNode) {\n        element.parentNode.replaceChild(button, element);\n      }\n      button.addEventListener('click', async (e) => {\n        e.preventDefault();\n        await handleLLMClick(llm, config, tracker, button);\n      });\n      return button;\n    }\n  } else {\n    element.addEventListener('click', async (e) => {\n      e.preventDefault();\n      await handleLLMClick(llm, config, tracker, element);\n    });\n  }\n\n  return element;\n}\n\n/**\n * Generate LLM URL with prompt\n */\nfunction generateLLMUrl(\n  llm: LLMConfig,\n  _config: NormalizedLLMShareConfig\n): string | null {\n  if (!llm.urlTemplate) {\n    return null;\n  }\n\n  const currentUrl = window.location.href;\n  const path = window.location.pathname || '/';\n  \n  // Generate prompt similar to ExploreWithAI component\n  const prompt = encodeURIComponent(\n    `Provide a detailed summary of ${currentUrl} so I can ask questions about it`\n  );\n\n  // Replace placeholders in URL template (if they exist)\n  let url = llm.urlTemplate;\n  if (url.includes('{url}')) {\n    url = url.replace('{url}', encodeURIComponent(currentUrl));\n  }\n  if (url.includes('{prompt}')) {\n    url = url.replace('{prompt}', prompt);\n  }\n  if (url.includes('{path}')) {\n    url = url.replace('{path}', encodeURIComponent(path));\n  }\n\n  return url;\n}\n\n/**\n * Get or create live region for accessibility announcements\n */\nfunction getLiveRegion(): HTMLElement {\n  let liveRegion = document.getElementById('llm-share-live-region');\n  if (!liveRegion) {\n    liveRegion = document.createElement('div');\n    liveRegion.id = 'llm-share-live-region';\n    liveRegion.setAttribute('role', 'status');\n    liveRegion.setAttribute('aria-live', 'polite');\n    liveRegion.setAttribute('aria-atomic', 'true');\n    liveRegion.className = 'llm-share-live-region';\n    // Visually hidden but accessible to screen readers\n    liveRegion.style.position = 'absolute';\n    liveRegion.style.left = '-10000px';\n    liveRegion.style.width = '1px';\n    liveRegion.style.height = '1px';\n    liveRegion.style.overflow = 'hidden';\n    document.body.appendChild(liveRegion);\n  }\n  return liveRegion;\n}\n\n/**\n * Announce message to screen readers\n */\nfunction announceToScreenReader(message: string): void {\n  const liveRegion = getLiveRegion();\n  liveRegion.textContent = message;\n  // Clear after announcement to allow re-announcement of same message\n  setTimeout(() => {\n    liveRegion.textContent = '';\n  }, 1000);\n}\n\n/**\n * Handle LLM button click\n */\nasync function handleLLMClick(\n  llm: LLMConfig,\n  config: NormalizedLLMShareConfig,\n  tracker: EventTracker,\n  buttonElement?: HTMLElement\n): Promise<void> {\n  // Track click\n  tracker.trackClick(llm.id);\n\n  const currentUrl = window.location.href;\n\n  if (llm.action === 'copy') {\n    // Try to create share URL first (if endpoint available)\n    let finalUrl = currentUrl;\n    \n    if (config.endpoints.share) {\n      try {\n        const pageTitle = typeof document !== 'undefined' ? document.title : undefined;\n        const viewId = tracker.getViewId();\n        const shareUrl = await createShareUrl(\n          currentUrl,\n          config.endpoints.share,\n          config.siteId,\n          config.publicKey,\n          llm.id,\n          pageTitle,\n          viewId\n        );\n        if (shareUrl) {\n          finalUrl = shareUrl;\n          tracker.trackShareCreated(llm.id, shareUrl);\n        } else {\n          tracker.trackFallbackRawUrl(llm.id, currentUrl);\n        }\n      } catch (error) {\n        tracker.trackFallbackRawUrl(llm.id, currentUrl);\n      }\n    }\n\n    // Compose prompt\n    const prompt = composePrompt(config, finalUrl);\n\n    // Copy to clipboard\n    const success = await copyToClipboard(prompt);\n    \n    if (success) {\n      // Announce success to screen readers\n      announceToScreenReader(`Content copied to clipboard for ${llm.label}`);\n      \n      // Restore focus to button for keyboard users\n      if (buttonElement && typeof buttonElement.focus === 'function') {\n        // Use setTimeout to ensure clipboard operation completes first\n        setTimeout(() => {\n          buttonElement.focus();\n        }, 100);\n      }\n      \n      if (config.debug.logToConsole) {\n        console.log('[LLMShare] Copied to clipboard:', prompt);\n      }\n    } else {\n      // Announce failure to screen readers\n      announceToScreenReader(`Failed to copy content to clipboard for ${llm.label}`);\n      \n      tracker.trackError('Failed to copy to clipboard', 'clipboard_error');\n      if (config.debug.logToConsole) {\n        console.error('[LLMShare] Failed to copy to clipboard');\n      }\n    }\n  } else if (llm.action === 'link' && llm.urlTemplate) {\n    const url = generateLLMUrl(llm, config);\n    if (url) {\n      window.open(url, '_blank', 'noopener,noreferrer');\n    }\n  }\n}\n\n","/**\n * Create share URL via endpoint\n */\nexport async function createShareUrl(\n  url: string,\n  shareEndpoint: string,\n  siteId: string | null,\n  publicKey: string | null,\n  llmId: string,\n  pageTitle?: string,\n  viewId?: string\n): Promise<string | null> {\n  try {\n    const response = await fetch(shareEndpoint, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        url,\n        site_id: siteId,\n        public_key: publicKey,\n        llm_id: llmId,\n        page_title: pageTitle,\n        view_id: viewId,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    \n    // Check for share_url first (preferred format from API)\n    if (data.share_url) {\n      return data.share_url;\n    } else if (data.token && data.redirect_base) {\n      // Fallback: construct URL from token and redirect_base\n      const slug = data.slug ? `/${data.slug}` : '';\n      return `${data.redirect_base}${data.token}${slug}`;\n    } else if (data.url) {\n      return data.url;\n    }\n\n    return null;\n  } catch (error) {\n    // Silently fail - will fallback to raw URL\n    return null;\n  }\n}\n\n","import type { NormalizedLLMShareConfig } from '../config/types';\n\n/**\n * Compose prompt text with page information\n */\nexport function composePrompt(\n  config: NormalizedLLMShareConfig,\n  url: string\n): string {\n  const parts: string[] = [];\n\n  // Add prompt template\n  if (config.content.prompt) {\n    parts.push(config.content.prompt);\n  }\n\n  // Add page title if enabled\n  if (config.content.includePageTitle && typeof document !== 'undefined') {\n    const title = document.title || '';\n    if (title) {\n      parts.push(`\\n\\nPage: ${title}`);\n    }\n  }\n\n  // Add selected text if enabled and present\n  if (\n    config.content.includeSelectedText &&\n    typeof window !== 'undefined' &&\n    window.getSelection\n  ) {\n    const selection = window.getSelection();\n    if (selection && selection.toString().trim()) {\n      const selectedText = selection.toString().trim();\n      if (selectedText.length > 0 && selectedText.length < 1000) {\n        // Limit selected text length\n        parts.push(`\\n\\nSelected text: ${selectedText}`);\n      }\n    }\n  }\n\n  // Add URL\n  parts.push(`\\n\\nURL: ${url}`);\n\n  return parts.join('');\n}\n\n","import type { NormalizedLLMShareConfig } from '../config/types';\nimport type { EventTracker } from '../events/tracker';\nimport { injectStyles, getEffectiveTheme } from './styles';\nimport { createLLMButton } from './Button';\nimport { isBrowserSupported, isMobileDevice } from '../utils/browser';\n\n/**\n * Widget container class\n */\nexport class Widget {\n  private config: NormalizedLLMShareConfig;\n  private tracker: EventTracker;\n  private container: HTMLElement | null = null;\n  private isInitialized = false;\n  private isVisible = false;\n  private showTextInitially = true;\n  private scrollRafRef: number | null = null;\n  private textContainer: HTMLElement | null = null;\n  private scrollHandler: (() => void) | null = null;\n\n  constructor(config: NormalizedLLMShareConfig, tracker: EventTracker) {\n    this.config = config;\n    this.tracker = tracker;\n  }\n\n  /**\n   * Initialize and render widget\n   */\n  init(): void {\n    if (this.isInitialized) {\n      return;\n    }\n\n    // Check browser support\n    if (!isBrowserSupported()) {\n      if (this.config.debug.logToConsole) {\n        console.warn('[LLMShare] Browser not supported');\n      }\n      return;\n    }\n\n    // Check if widget should be shown on this page\n    if (!this.shouldShow()) {\n      return;\n    }\n\n    // Inject styles\n    injectStyles(this.config);\n\n    // Create container\n    this.container = this.createContainer();\n\n    // Render LLM buttons\n    this.renderButtons();\n\n    // Append to DOM\n    this.appendToDOM();\n\n    // Setup scroll detection if enabled\n    this.setupScrollDetection();\n\n    // Track impression\n    this.tracker.trackImpression();\n\n    // Call onReady callback\n    if (this.config.callbacks.onReady) {\n      try {\n        this.config.callbacks.onReady();\n      } catch (error) {\n        if (this.config.debug.logToConsole) {\n          console.error('[LLMShare] Error in onReady callback:', error);\n        }\n      }\n    }\n\n    this.isInitialized = true;\n  }\n\n  /**\n   * Check if widget should be shown on current page\n   */\n  private shouldShow(): boolean {\n    if (typeof window === 'undefined') {\n      return false;\n    }\n\n    // Check mobile visibility flag\n    if (!this.config.widget.showOnMobile && isMobileDevice()) {\n      return false;\n    }\n\n    const pathPrefix = this.config.widget.showOn.pathPrefix;\n    if (pathPrefix && pathPrefix !== '/') {\n      const currentPath = window.location.pathname;\n      if (!currentPath.startsWith(pathPrefix)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Create widget container element\n   */\n  private createContainer(): HTMLElement {\n    const container = document.createElement('div');\n    container.className = 'llm-share-widget';\n    container.setAttribute('role', 'region');\n    container.setAttribute('aria-label', 'AI assistant options');\n\n    // Handle inline vs overlay mode\n    if (this.config.widget.placement === 'inline' && this.config.widget.inlineSelector) {\n      container.classList.add('inline');\n      // Add alignment class\n      const alignment = this.config.widget.inlineAlignment ?? 'left';\n      container.classList.add(`align-${alignment}`);\n      return container;\n    }\n\n    // Overlay mode - set position\n    container.style.position = 'fixed';\n    \n    // Add placement class for CSS targeting\n    container.classList.add(`placement-${this.config.widget.placement}`);\n    \n    if (this.config.widget.placement === 'center-right') {\n      container.style.right = `${this.config.widget.offsetPx}px`;\n      container.style.top = '50%';\n      container.style.transform = 'translateY(-50%)';\n    } else if (this.config.widget.placement === 'center-left') {\n      container.style.left = `${this.config.widget.offsetPx}px`;\n      container.style.top = '50%';\n      container.style.transform = 'translateY(-50%)';\n    } else if (this.config.widget.placement === 'bottom-right') {\n      container.style.right = `${this.config.widget.offsetPx}px`;\n      container.style.bottom = `${this.config.widget.offsetPx}px`;\n    } else if (this.config.widget.placement === 'bottom-left') {\n      container.style.left = `${this.config.widget.offsetPx}px`;\n      container.style.bottom = `${this.config.widget.offsetPx}px`;\n      // Add initial hidden state if scroll-based visibility is enabled\n      if (this.config.widget.showOn?.showOnScroll) {\n        container.classList.add('scroll-hidden');\n      }\n    }\n\n    return container;\n  }\n\n  /**\n   * Setup scroll detection for widget visibility\n   */\n  private setupScrollDetection(): void {\n    if (!this.config.widget.showOn?.showOnScroll || !this.container) {\n      return;\n    }\n\n    const scrollDistance = this.config.widget.showOn.scrollDistance ?? 200;\n\n    this.scrollHandler = () => {\n      if (this.scrollRafRef !== null) {\n        cancelAnimationFrame(this.scrollRafRef);\n      }\n\n      this.scrollRafRef = requestAnimationFrame(() => {\n        const scrollY = window.scrollY || window.pageYOffset;\n        const shouldBeVisible = scrollY > scrollDistance;\n        \n        if (shouldBeVisible !== this.isVisible) {\n          this.isVisible = shouldBeVisible;\n          if (this.container) {\n            if (shouldBeVisible) {\n              this.container.classList.remove('scroll-hidden');\n              // Start text hide timer when widget becomes visible\n              this.startTextHideTimer();\n            } else {\n              this.container.classList.add('scroll-hidden');\n              this.showTextInitially = true; // Reset text visibility\n              if (this.textContainer) {\n                this.textContainer.classList.add('text-visible');\n              }\n            }\n          }\n        }\n      });\n    };\n\n    // Initial check\n    if (this.scrollHandler) {\n      this.scrollHandler();\n      // If widget is already visible after initial check, start timer\n      if (this.isVisible && this.config.widget.textLabel?.enabled) {\n        const textPosition = this.config.widget.textLabel?.position ?? 'right';\n        const isHorizontal = textPosition === 'left' || textPosition === 'right';\n        if (isHorizontal) {\n          this.startTextHideTimer();\n        }\n      }\n    }\n\n    window.addEventListener('scroll', this.scrollHandler, { passive: true });\n  }\n\n  /**\n   * Start timer to hide text label\n   */\n  private startTextHideTimer(): void {\n    if (!this.config.widget.textLabel?.enabled) {\n      return;\n    }\n\n    const hideDelay = this.config.widget.textLabel.hideDelay ?? 3000;\n    \n    setTimeout(() => {\n      this.showTextInitially = false;\n      if (this.textContainer) {\n        this.textContainer.classList.remove('text-visible');\n      }\n    }, hideDelay);\n  }\n\n  /**\n   * Create text label element\n   */\n  private createTextLabel(): HTMLElement | null {\n    if (!this.config.widget.textLabel?.enabled) {\n      return null;\n    }\n\n    const textLabel = this.config.widget.textLabel.text ?? 'Explore with AI';\n    const textContainer = document.createElement('div');\n    textContainer.className = 'llm-share-text-label';\n    \n    const textSpan = document.createElement('span');\n    textSpan.textContent = textLabel;\n    textContainer.appendChild(textSpan);\n\n    // Measure text width and set CSS variable for smooth transition\n    // Use canvas to measure text width accurately\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.font = '500 14px -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif';\n      const textWidth = Math.ceil(context.measureText(textLabel).width);\n      textContainer.style.setProperty('--text-label-width', `${textWidth}px`);\n    } else {\n      // Fallback: create temporary span to measure\n      const tempSpan = document.createElement('span');\n      tempSpan.style.visibility = 'hidden';\n      tempSpan.style.position = 'absolute';\n      tempSpan.style.top = '-9999px';\n      tempSpan.style.fontWeight = '500';\n      tempSpan.style.fontSize = '14px';\n      tempSpan.style.fontFamily = '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif';\n      tempSpan.style.whiteSpace = 'nowrap';\n      tempSpan.textContent = textLabel;\n      document.body.appendChild(tempSpan);\n      const textWidth = Math.ceil(tempSpan.offsetWidth);\n      document.body.removeChild(tempSpan);\n      textContainer.style.setProperty('--text-label-width', `${textWidth}px`);\n    }\n    textContainer.classList.add('text-visible');\n    this.textContainer = textContainer;\n    return textContainer;\n  }\n\n  /**\n   * Render LLM buttons\n   */\n  private renderButtons(): void {\n    if (!this.container) {\n      return;\n    }\n\n    const buttonContainer = document.createElement('div');\n    buttonContainer.className = 'llm-share-widget-container';\n    \n    // Add style class for CSS targeting\n    buttonContainer.classList.add(`style-${this.config.widget.style}`);\n    \n    // Add theme class for CSS targeting\n    const theme = getEffectiveTheme(this.config);\n    buttonContainer.classList.add(`theme-${theme}`);\n    \n    // Determine text position\n    const textPosition = this.config.widget.textLabel?.position ?? 'right';\n    const isHorizontal = textPosition === 'left' || textPosition === 'right';\n    const isRight = textPosition === 'right';\n    \n    if (isHorizontal) {\n      buttonContainer.classList.add('layout-horizontal');\n      if (isRight) {\n        buttonContainer.classList.add('text-right');\n      }\n    } else {\n      buttonContainer.classList.add('layout-vertical');\n    }\n\n    // Create buttons wrapper\n    const buttonsWrapper = document.createElement('div');\n    buttonsWrapper.className = 'llm-share-buttons-wrapper';\n    buttonsWrapper.setAttribute('role', 'group');\n    buttonsWrapper.setAttribute('aria-label', 'AI assistant buttons');\n\n    for (const llm of this.config.llms) {\n      const button = createLLMButton(llm, this.config, this.tracker, buttonsWrapper);\n      buttonsWrapper.appendChild(button);\n    }\n\n    // Add text label if enabled\n    const textLabel = this.createTextLabel();\n    \n    if (textLabel && isHorizontal) {\n      if (isRight) {\n        // Text on the right - add after buttons\n        buttonContainer.appendChild(buttonsWrapper);\n        buttonContainer.appendChild(textLabel);\n      } else {\n        // Text on the left - add before buttons\n        buttonContainer.appendChild(textLabel);\n        buttonContainer.appendChild(buttonsWrapper);\n      }\n    } else if (textLabel && !isHorizontal) {\n      // Vertical layout - text on top\n      buttonContainer.appendChild(buttonsWrapper);\n      buttonContainer.insertBefore(textLabel, buttonsWrapper);\n    } else {\n      // No text label\n      buttonContainer.appendChild(buttonsWrapper);\n    }\n\n    this.container.appendChild(buttonContainer);\n\n    // Setup hover for text expansion (only for horizontal layout)\n    if (textLabel && this.config.widget.textLabel?.enabled && isHorizontal) {\n      buttonContainer.addEventListener('mouseenter', () => {\n        if (!this.showTextInitially && this.textContainer) {\n          this.textContainer.classList.add('text-visible');\n        }\n      });\n\n      buttonContainer.addEventListener('mouseleave', () => {\n        if (!this.showTextInitially && this.textContainer) {\n          this.textContainer.classList.remove('text-visible');\n        }\n      });\n      \n      // Start hide timer for horizontal layouts (only if widget is visible)\n      // If scroll detection is enabled, the timer will start when widget becomes visible\n      if (!this.config.widget.showOn?.showOnScroll || !this.container?.classList.contains('scroll-hidden')) {\n        this.startTextHideTimer();\n      }\n    }\n  }\n\n  /**\n   * Append widget to DOM\n   */\n  private appendToDOM(): void {\n    if (!this.container || typeof document === 'undefined') {\n      return;\n    }\n\n    // Inline mode - find target element\n    if (this.config.widget.placement === 'inline' && this.config.widget.inlineSelector) {\n      const target = document.querySelector(this.config.widget.inlineSelector);\n      if (target) {\n        // Add alignment class to parent container if it exists\n        const alignment = this.config.widget.inlineAlignment ?? 'left';\n        if (target instanceof HTMLElement) {\n          target.classList.add(`align-${alignment}`);\n        }\n        target.appendChild(this.container);\n        return;\n      }\n    }\n\n    // Overlay mode - append to body\n    document.body.appendChild(this.container);\n  }\n\n  /**\n   * Destroy widget\n   */\n  destroy(): void {\n    if (this.scrollRafRef !== null) {\n      cancelAnimationFrame(this.scrollRafRef);\n    }\n    \n    if (this.scrollHandler) {\n      window.removeEventListener('scroll', this.scrollHandler);\n    }\n    \n    if (this.container && this.container.parentNode) {\n      this.container.parentNode.removeChild(this.container);\n    }\n    this.container = null;\n    this.textContainer = null;\n    this.isInitialized = false;\n    this.isVisible = false;\n    this.showTextInitially = true;\n  }\n}\n\n","/**\n * Main widget entry point\n */\n\nimport type { LLMShareConfig } from './config/types';\nimport { getConfig } from './config/schema';\nimport { EventTracker } from './events/tracker';\nimport { Widget } from './ui/Widget';\nimport { getDefaultIcon } from './icons';\n\nimport { validateConfig } from './config/schema';\n\n/**\n * Initialize widget\n */\nexport function init(config?: LLMShareConfig): void {\n  // Prevent double initialization\n  if (typeof window !== 'undefined' && window.__LLMShareInstance) {\n    return;\n  }\n\n  // Get config from window or parameter\n  let normalizedConfig;\n  \n  if (config) {\n    // Config passed directly (from loader)\n    normalizedConfig = validateConfig(config);\n  } else {\n    // Get from window\n    normalizedConfig = getConfig();\n  }\n\n  if (!normalizedConfig) {\n    console.error('[LLMShare] Failed to initialize: invalid or missing config');\n    return;\n  }\n\n  // Add default icons to LLM configs if not provided\n  for (const llm of normalizedConfig.llms) {\n    if (!llm.iconSvg && !llm.iconUrl) {\n      const defaultIcon = getDefaultIcon(llm.id);\n      if (defaultIcon) {\n        llm.iconSvg = defaultIcon;\n      }\n    }\n  }\n\n  // Create event tracker\n  const tracker = new EventTracker(normalizedConfig);\n\n  // Create and initialize widget\n  const widget = new Widget(normalizedConfig, tracker);\n  widget.init();\n\n  // Expose widget instance for cleanup if needed\n  if (typeof window !== 'undefined') {\n    window.__LLMShareInstance = {\n      widget,\n      tracker,\n      destroy: () => {\n        widget.destroy();\n        tracker.destroy();\n        delete window.__LLMShareInstance;\n      },\n    };\n    // Clear loading flag now that we're initialized\n    delete window.__LLMShareLoading;\n  }\n}\n\n// Export for UMD/IIFE builds\nif (typeof window !== 'undefined') {\n  window.LLMShareWidget = {\n    init,\n  };\n  \n  // Auto-init only if NOT loaded via loader (loader sets __LLMShareLoading flag)\n  if (window.LLMShare && !window.__LLMShareLoading) {\n    const doInit = () => {\n      if (!window.__LLMShareInstance) {\n        init();\n      }\n    };\n    \n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', doInit);\n    } else {\n      doInit();\n    }\n  }\n}\n\n"],"names":["CHATGPT_ICON","CLAUDE_ICON","GEMINI_ICON","PERPLEXITY_ICON","COPY_ICON","getDefaultIcon","llmId","chatgpt","claude","gemini","perplexity","copy","toLowerCase","LLM_METADATA","label","iconSvg","urlTemplate","DEFAULT_LLM_NAMES","applyDefaults","config","mode","siteId","publicKey","detectMode","defaultEndpoints","collector","share","redirectBase","getDefaultEndpoints","action","llms","llmNames","map","name","normalizedName","metadata","llmAction","id","charAt","toUpperCase","slice","expandLLMs","length","version","endpoints","widget","placement","style","theme","zIndex","offsetPx","backgroundOpacity","inlineSelector","inlineAlignment","showOnMobile","showOn","pathPrefix","scrollDistance","showOnScroll","textLabel","enabled","text","position","hideDelay","content","prompt","includePageTitle","includeSelectedText","tracking","batch","flushIntervalMs","respectDNT","pushToDataLayer","dataLayerName","callbacks","onEvent","onReady","debug","logToConsole","validateConfig","Error","configObj","validModes","includes","join","validPlacements","validPositions","validStyles","validThemes","Array","isArray","llm","generateUUID","replace","c","r","Math","random","toString","EventTracker","constructor","this","eventQueue","flushTimer","unloadHandler","viewId","setupUnloadHandler","getAttributionData","window","navigator","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","referrer","document","language","screen_width","screen","width","screen_height","height","viewport_width","innerWidth","viewport_height","innerHeight","error","getViewId","createBaseEvent","eventType","event_id","ts","Date","toISOString","event_type","site_id","page_url","location","href","view_id","event","windowWithDataLayer","push","console","emit","log","scheduleFlush","trackImpression","trackClick","llm_id","trackShareCreated","shareUrl","shareToken","share_url","share_token","trackFallbackRawUrl","rawUrl","raw_url","trackError","errorMessage","errorType","error_message","error_type","requestIdleCallback","flush","setTimeout","doNotTrack","events","response","fetch","method","headers","body","JSON","stringify","public_key","keepalive","ok","status","statusText","unshift","sendBeacon","payload","Blob","type","xhr","XMLHttpRequest","open","setRequestHeader","send","addEventListener","destroy","removeEventListener","clearTimeout","getEffectiveTheme","matchMedia","matches","injectStyles","styleId","existing","getElementById","remove","createElement","textContent","isDark","opacity","borderRadius","backgroundDark","backgroundLight","backgroundRight","generateStyles","head","appendChild","async","copyToClipboard","clipboard","writeText","textArea","value","left","top","focus","select","success","execCommand","removeChild","createLLMButton","tracker","_container","element","className","ariaLabel","setAttribute","HTMLButtonElement","HTMLAnchorElement","iconContainer","innerHTML","iconUrl","icon","src","alt","url","generateLLMUrl","button","getAttribute","firstChild","parentNode","replaceChild","e","preventDefault","handleLLMClick","warn","_config","currentUrl","path","pathname","encodeURIComponent","announceToScreenReader","message","liveRegion","overflow","getLiveRegion","buttonElement","finalUrl","pageTitle","title","shareEndpoint","page_title","data","json","token","redirect_base","slug","createShareUrl","parts","getSelection","selection","trim","selectedText","composePrompt","Widget","container","isInitialized","isVisible","showTextInitially","scrollRafRef","textContainer","scrollHandler","init","Promise","shouldShow","createContainer","renderButtons","appendToDOM","setupScrollDetection","isSmallScreen","userAgent","vendor","String","opera","isMobileUA","test","isMobileDevice","startsWith","classList","add","alignment","right","transform","bottom","cancelAnimationFrame","requestAnimationFrame","shouldBeVisible","scrollY","pageYOffset","startTextHideTimer","textPosition","passive","createTextLabel","textSpan","context","getContext","font","textWidth","ceil","measureText","setProperty","tempSpan","visibility","fontWeight","fontSize","fontFamily","whiteSpace","offsetWidth","buttonContainer","isHorizontal","isRight","buttonsWrapper","insertBefore","contains","target","querySelector","HTMLElement","__LLMShareInstance","normalizedConfig","windowWithConfig","LLMShare","getConfig","defaultIcon","__LLMShareLoading","LLMShareWidget","doInit","readyState"],"mappings":"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"}